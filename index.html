<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iFinder - Encontre Seu Imóvel Ideal | WB Negócios</title>
    <meta name="description" content="iFinder - A forma mais inteligente de encontrar seu imóvel ideal. Sistema de matching avançado para compra, venda e locação de imóveis.">
    <meta name="keywords" content="imóveis, casas, apartamentos, venda, locação, WB Negócios, iFinder">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiByeD0iOCIgZmlsbD0iIzAwMjE0RCIvPgo8cGF0aCBkPSJNOCAxMkwxNiA2TDI0IDEyVjI0SDE4VjE4SDEwVjI0SDhWMTJaIiBmaWxsPSIjREFBNTIwIi8+Cjwvc3ZnPgo=">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --wb-blue: #00214D;
            --wb-gold: #DAA520;
            --wb-light-blue: #E8F4FD;
            --wb-dark-blue: #001A3D;
            --text-primary: #2D3748;
            --text-secondary: #718096;
            --bg-light: #F7FAFC;
            --border-color: #E2E8F0;
            --success: #48BB78;
            --error: #F56565;
            --warning: #ED8936;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --border-radius: 12px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: var(--text-primary);
            background: linear-gradient(135deg, var(--bg-light) 0%, #ffffff 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Landing Page Styles */
        .landing-page {
            min-height: 100vh;
            background: linear-gradient(135deg, var(--wb-blue) 0%, var(--wb-dark-blue) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .landing-page::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(218,165,32,0.1)" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
            opacity: 0.3;
        }

        .landing-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            text-align: center;
            position: relative;
            z-index: 1;
        }

        .logo-container {
            margin-bottom: 3rem;
            animation: fadeInUp 1s ease-out;
        }

        .logo {
            width: 120px;
            height: 120px;
            margin: 0 auto 1rem;
            background: var(--wb-gold);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow-lg);
        }

        .logo i {
            font-size: 3rem;
            color: var(--wb-blue);
        }

        .hero-title {
            font-size: 3.5rem;
            font-weight: 700;
            color: white;
            margin-bottom: 1rem;
            line-height: 1.2;
            animation: fadeInUp 1s ease-out 0.2s both;
        }

        .hero-subtitle {
            font-size: 1.25rem;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 3rem;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            animation: fadeInUp 1s ease-out 0.4s both;
        }

        .cta-button {
            background: linear-gradient(135deg, var(--wb-gold) 0%, #B8860B 100%);
            color: var(--wb-blue);
            padding: 1rem 3rem;
            border: none;
            border-radius: var(--border-radius);
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow-lg);
            animation: fadeInUp 1s ease-out 0.6s both;
            text-decoration: none;
            display: inline-block;
        }

        .cta-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-top: 4rem;
            animation: fadeInUp 1s ease-out 0.8s both;
        }

        .feature-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--border-radius);
            padding: 2rem;
            text-align: center;
            transition: var(--transition);
        }

        .feature-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.15);
        }

        .feature-icon {
            font-size: 2.5rem;
            color: var(--wb-gold);
            margin-bottom: 1rem;
        }

        .feature-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: white;
            margin-bottom: 0.5rem;
        }

        .feature-description {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.95rem;
        }

        /* Auth Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            z-index: 1000;
            animation: fadeIn 0.3s ease-out;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            border-radius: var(--border-radius);
            padding: 2rem;
            width: 90%;
            max-width: 450px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-lg);
            animation: slideInUp 0.3s ease-out;
        }

        .modal-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .modal-title {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--wb-blue);
            margin-bottom: 0.5rem;
        }

        .modal-subtitle {
            color: var(--text-secondary);
            font-size: 0.95rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
            font-size: 0.95rem;
        }

        .form-input {
            width: 100%;
            padding: 0.875rem 1rem;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
            background: white;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--wb-blue);
            box-shadow: 0 0 0 3px rgba(0, 33, 77, 0.1);
        }

        .form-select {
            width: 100%;
            padding: 0.875rem 1rem;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            font-size: 1rem;
            background: white;
            cursor: pointer;
            transition: var(--transition);
        }

        .form-select:focus {
            outline: none;
            border-color: var(--wb-blue);
            box-shadow: 0 0 0 3px rgba(0, 33, 77, 0.1);
        }

        .form-textarea {
            width: 100%;
            padding: 0.875rem 1rem;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
            background: white;
            resize: vertical;
            min-height: 100px;
            font-family: inherit;
        }

        .form-textarea:focus {
            outline: none;
            border-color: var(--wb-blue);
            box-shadow: 0 0 0 3px rgba(0, 33, 77, 0.1);
        }

        .btn-primary {
            width: 100%;
            background: linear-gradient(135deg, var(--wb-blue) 0%, var(--wb-dark-blue) 100%);
            color: white;
            padding: 1rem;
            border: none;
            border-radius: var(--border-radius);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            margin-bottom: 1rem;
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-lg);
        }

        .btn-secondary {
            width: 100%;
            background: transparent;
            color: var(--wb-blue);
            padding: 1rem;
            border: 2px solid var(--wb-blue);
            border-radius: var(--border-radius);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        .btn-secondary:hover {
            background: var(--wb-blue);
            color: white;
        }

        .btn-danger {
            background: var(--error);
            color: white;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: var(--border-radius);
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
        }

        .btn-danger:hover {
            background: #E53E3E;
            transform: translateY(-1px);
        }

        .btn-edit {
            background: var(--wb-gold);
            color: var(--wb-blue);
            padding: 0.5rem 1rem;
            border: none;
            border-radius: var(--border-radius);
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
        }

        .btn-edit:hover {
            background: #B8860B;
            transform: translateY(-1px);
        }

        .close-modal {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--text-secondary);
            cursor: pointer;
            transition: var(--transition);
        }

        .close-modal:hover {
            color: var(--text-primary);
        }

        /* App Container Styles */
        .app-container {
            display: none;
            min-height: 100vh;
            background: var(--bg-light);
        }

        .app-container.active {
            display: block;
        }

        /* Header Styles */
        .app-header {
            background: white;
            border-bottom: 1px solid var(--border-color);
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: var(--shadow);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .header-logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .header-logo-icon {
            width: 40px;
            height: 40px;
            background: var(--wb-gold);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--wb-blue);
            font-size: 1.25rem;
        }

        .header-logo-text {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--wb-blue);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            background: var(--wb-blue);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            overflow: hidden;
        }

        .user-avatar:hover {
            transform: scale(1.05);
        }

        .user-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }

        .user-name {
            font-weight: 500;
            color: var(--text-primary);
        }

        .logout-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 0.5rem;
            border-radius: var(--border-radius);
            transition: var(--transition);
        }

        .logout-btn:hover {
            background: var(--bg-light);
            color: var(--text-primary);
        }

        /* Navigation Styles */
        .app-nav {
            background: white;
            border-bottom: 1px solid var(--border-color);
            padding: 0;
        }

        .nav-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
        }

        .nav-item {
            flex: 1;
            padding: 1rem;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            border-bottom: 3px solid transparent;
            color: var(--text-secondary);
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .nav-item:hover {
            background: var(--bg-light);
            color: var(--text-primary);
        }

        .nav-item.active {
            color: var(--wb-blue);
            border-bottom-color: var(--wb-blue);
            background: var(--wb-light-blue);
        }

        .nav-item i {
            font-size: 1.1rem;
        }

        /* Main Content Styles */
        .app-main {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
        }

        /* Dashboard Styles */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .stat-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 2rem;
            box-shadow: var(--shadow);
            transition: var(--transition);
            border-left: 4px solid var(--wb-gold);
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .stat-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1rem;
        }

        .stat-title {
            font-size: 0.95rem;
            font-weight: 500;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-icon {
            width: 48px;
            height: 48px;
            background: var(--wb-light-blue);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--wb-blue);
            font-size: 1.25rem;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--wb-blue);
            margin-bottom: 0.5rem;
        }

        .stat-description {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Swipe Container Styles */
        .swipe-container {
            max-width: 400px;
            margin: 0 auto;
            position: relative;
            height: 600px;
            perspective: 1000px;
        }

        .property-card {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-lg);
            cursor: grab;
            transition: transform 0.3s ease-out;
            overflow: hidden;
            user-select: none;
        }

        .property-card:active {
            cursor: grabbing;
        }

        .property-card.dragging {
            transition: none;
            z-index: 10;
        }

        .property-card.swiped-right {
            transform: translateX(100%) rotate(20deg);
            opacity: 0;
        }

        .property-card.swiped-left {
            transform: translateX(-100%) rotate(-20deg);
            opacity: 0;
        }

        .property-image {
            width: 100%;
            height: 300px;
            object-fit: cover;
            border-radius: var(--border-radius) var(--border-radius) 0 0;
        }

        .property-content {
            padding: 1.5rem;
        }

        .property-price {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--wb-blue);
            margin-bottom: 0.5rem;
        }

        .property-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .property-location {
            color: var(--text-secondary);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .property-features {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .feature {
            display: flex;
            align-items: center;
            gap: 0.25rem;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .property-description {
            color: var(--text-secondary);
            font-size: 0.95rem;
            line-height: 1.5;
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 2rem;
        }

        .action-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: var(--shadow);
        }

        .action-btn:hover {
            transform: scale(1.1);
            box-shadow: var(--shadow-lg);
        }

        .reject-btn {
            background: #FED7D7;
            color: var(--error);
        }

        .super-like-btn {
            background: #BEE3F8;
            color: #3182CE;
        }

        .like-btn {
            background: #C6F6D5;
            color: var(--success);
        }

        /* Filters */
        .filters {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 0.75rem 1.5rem;
            border: 2px solid var(--border-color);
            background: white;
            border-radius: 25px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
        }

        .filter-btn.active {
            background: var(--wb-blue);
            color: white;
            border-color: var(--wb-blue);
        }

        .filter-btn:hover {
            border-color: var(--wb-blue);
        }

        /* Matches Section */
        .matches-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 2rem;
        }

        .matches-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .matches-view-toggle {
            display: flex;
            background: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .view-toggle-btn {
            padding: 0.75rem 1.5rem;
            border: none;
            background: white;
            color: var(--text-secondary);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 500;
        }

        .view-toggle-btn.active {
            background: var(--wb-blue);
            color: white;
        }

        .view-toggle-btn:hover:not(.active) {
            background: var(--bg-light);
            color: var(--text-primary);
        }

        .matches-content {
            position: relative;
        }

        .matches-list-view {
            display: block;
        }

        .matches-map-view {
            display: none;
        }

        .matches-map-view.active {
            display: block;
        }

        .matches-list-view.active {
            display: block;
        }

        /* Map Styles */
        .map-container {
            height: 600px;
            width: 100%;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            position: relative;
        }

        .map-controls {
            position: absolute;
            top: 1rem;
            right: 1rem;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .map-control-btn {
            background: white;
            border: none;
            padding: 0.75rem;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            cursor: pointer;
            transition: var(--transition);
            color: var(--text-primary);
        }

        .map-control-btn:hover {
            background: var(--bg-light);
        }

        .map-info-panel {
            position: absolute;
            bottom: 1rem;
            left: 1rem;
            right: 1rem;
            background: white;
            border-radius: var(--border-radius);
            padding: 1rem;
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            display: none;
        }

        .map-info-panel.active {
            display: block;
        }

        .map-info-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.5rem;
        }

        .map-info-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin: 0;
        }

        .map-info-price {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--wb-blue);
        }

        .map-info-location {
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .map-info-features {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .map-info-actions {
            display: flex;
            gap: 0.5rem;
        }

        .map-info-btn {
            flex: 1;
            padding: 0.5rem;
            border: none;
            border-radius: var(--border-radius);
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
        }

        .map-info-btn.primary {
            background: var(--wb-blue);
            color: white;
        }

        .map-info-btn.secondary {
            background: var(--bg-light);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .map-info-btn:hover {
            transform: translateY(-1px);
        }

        .close-map-info {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 0.25rem;
            border-radius: 50%;
            transition: var(--transition);
        }

        .close-map-info:hover {
            background: var(--bg-light);
            color: var(--text-primary);
        }

        /* Custom Leaflet Popup Styles */
        .leaflet-popup-content-wrapper {
            border-radius: var(--border-radius) !important;
            box-shadow: var(--shadow-lg) !important;
        }

        .leaflet-popup-content {
            margin: 0 !important;
            padding: 0 !important;
        }

        .custom-popup {
            width: 280px;
            padding: 1rem;
        }

        .custom-popup img {
            width: 100%;
            height: 120px;
            object-fit: cover;
            border-radius: var(--border-radius);
            margin-bottom: 0.75rem;
        }

        .custom-popup h4 {
            margin: 0 0 0.5rem 0;
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .custom-popup .price {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--wb-blue);
            margin-bottom: 0.5rem;
        }

        .custom-popup .location {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .custom-popup .features {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 0.75rem;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .custom-popup .contact-btn {
            width: 100%;
            background: var(--wb-gold);
            color: var(--wb-blue);
            border: none;
            padding: 0.5rem;
            border-radius: var(--border-radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        /* Search and Filter Styles */
        .search-section {
            background: white;
            border-radius: var(--border-radius);
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow);
        }

        .search-tabs {
            display: flex;
            margin-bottom: 2rem;
            background: var(--bg-light);
            border-radius: var(--border-radius);
            padding: 0.25rem;
        }

        .search-tab {
            flex: 1;
            padding: 0.75rem 1rem;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            cursor: pointer;
            border-radius: calc(var(--border-radius) - 0.25rem);
            transition: var(--transition);
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .search-tab.active {
            background: white;
            color: var(--wb-blue);
            box-shadow: var(--shadow);
        }

        .search-content {
            display: none;
        }

        .search-content.active {
            display: block;
        }

        .search-bar {
            position: relative;
            margin-bottom: 1.5rem;
        }

        .search-input {
            width: 100%;
            padding: 1rem 1rem 1rem 3rem;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
            background: white;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--wb-blue);
            box-shadow: 0 0 0 3px rgba(0, 33, 77, 0.1);
        }

        .search-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
        }

        .filters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .filter-label {
            font-weight: 500;
            color: var(--text-primary);
            font-size: 0.9rem;
        }

        .filter-select {
            padding: 0.75rem;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            background: white;
            color: var(--text-primary);
            transition: var(--transition);
        }

        .filter-select:focus {
            outline: none;
            border-color: var(--wb-blue);
        }

        .price-range {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 0.5rem;
            align-items: center;
        }

        .price-input {
            padding: 0.75rem;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            background: white;
            text-align: center;
        }

        .price-separator {
            color: var(--text-secondary);
            font-weight: 500;
        }

        .filter-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
        }

        .filter-btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: var(--border-radius);
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .filter-btn.primary {
            background: var(--wb-blue);
            color: white;
        }

        .filter-btn.secondary {
            background: var(--bg-light);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .filter-btn:hover {
            transform: translateY(-1px);
        }

        .search-results {
            margin-top: 2rem;
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .results-count {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .sort-select {
            padding: 0.5rem 1rem;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            background: white;
        }

        .user-result {
            background: white;
            border-radius: var(--border-radius);
            padding: 1.5rem;
            margin-bottom: 1rem;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            gap: 1rem;
            transition: var(--transition);
        }

        .user-result:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .user-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--wb-blue);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 1.25rem;
        }

        .user-info {
            flex: 1;
        }

        .user-name {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }

        .user-type {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .user-stats {
            display: flex;
            gap: 1rem;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .user-actions {
            display: flex;
            gap: 0.5rem;
        }

        .user-btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: var(--border-radius);
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
        }

        .user-btn.primary {
            background: var(--wb-blue);
            color: white;
        }

        .user-btn.secondary {
            background: var(--bg-light);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .no-results {
            text-align: center;
            padding: 3rem;
            color: var(--text-secondary);
        }

        .no-results i {
            font-size: 3rem;
            margin-bottom: 1rem;
            color: var(--border-color);
        }

        .match-card {
            background: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .match-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .match-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .match-content {
            padding: 1.5rem;
        }

        .match-price {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--wb-blue);
            margin-bottom: 0.5rem;
        }

        .match-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .match-location {
            color: var(--text-secondary);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .match-features {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .contact-btn {
            width: 100%;
            background: var(--wb-gold);
            color: var(--wb-blue);
            padding: 0.75rem;
            border: none;
            border-radius: var(--border-radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        .contact-btn:hover {
            background: #B8860B;
        }

        /* Profile Section */
        .profile-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 2rem;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
        }

        .profile-header {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .profile-avatar {
            width: 80px;
            height: 80px;
            background: var(--wb-blue);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2rem;
            font-weight: 700;
            overflow: hidden;
            cursor: pointer;
            transition: var(--transition);
        }

        .profile-avatar:hover {
            transform: scale(1.05);
        }

        .profile-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }

        .profile-info h2 {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }

        .profile-info p {
            color: var(--text-secondary);
        }

        .profile-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .detail-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .detail-icon {
            width: 40px;
            height: 40px;
            background: var(--wb-light-blue);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--wb-blue);
        }

        .detail-content h4 {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }

        .detail-content p {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Property Form */
        .property-form {
            background: white;
            border-radius: var(--border-radius);
            padding: 2rem;
            box-shadow: var(--shadow);
        }

        .form-section {
            margin-bottom: 2rem;
        }

        .section-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--wb-blue);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        /* Account Management Styles */
        .account-tabs {
            display: flex;
            gap: 0;
            margin-bottom: 2rem;
            background: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .account-tab {
            flex: 1;
            padding: 1rem;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            background: white;
            color: var(--text-secondary);
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .account-tab:hover {
            background: var(--bg-light);
            color: var(--text-primary);
        }

        .account-tab.active {
            background: var(--wb-blue);
            color: white;
        }

        .account-content {
            display: none;
        }

        .account-content.active {
            display: block;
        }

        /* My Properties Styles */
        .properties-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 2rem;
        }

        .my-property-card {
            background: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            position: relative;
        }

        .my-property-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .property-status {
            position: absolute;
            top: 1rem;
            right: 1rem;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-active {
            background: var(--success);
            color: white;
        }

        .status-pending {
            background: var(--warning);
            color: white;
        }

        .status-inactive {
            background: var(--text-secondary);
            color: white;
        }

        .my-property-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .my-property-content {
            padding: 1.5rem;
        }

        .my-property-price {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--wb-blue);
            margin-bottom: 0.5rem;
        }

        .my-property-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .my-property-location {
            color: var(--text-secondary);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .property-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .property-actions button {
            flex: 1;
            padding: 0.5rem;
            border: none;
            border-radius: var(--border-radius);
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
        }

        /* File Upload Styles */
        .file-upload {
            position: relative;
            display: inline-block;
            cursor: pointer;
            width: 100%;
        }

        .file-upload input[type="file"] {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .file-upload-label {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 1rem;
            border: 2px dashed var(--border-color);
            border-radius: var(--border-radius);
            background: var(--bg-light);
            color: var(--text-secondary);
            transition: var(--transition);
        }

        .file-upload:hover .file-upload-label {
            border-color: var(--wb-blue);
            color: var(--wb-blue);
        }

        .avatar-upload {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            overflow: hidden;
            margin: 0 auto 1rem;
            position: relative;
            cursor: pointer;
            transition: var(--transition);
        }

        .avatar-upload:hover {
            transform: scale(1.05);
        }

        .avatar-upload img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .avatar-upload .file-upload-label {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 3px dashed var(--border-color);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            font-size: 0.9rem;
        }

        /* Image Gallery */
        .image-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .image-item {
            position: relative;
            aspect-ratio: 1;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .image-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .image-remove {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background: var(--error);
            color: white;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 0.8rem;
            transition: var(--transition);
        }

        .image-remove:hover {
            background: #E53E3E;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Toast Notifications */
        .toast {
            position: fixed;
            top: 2rem;
            right: 2rem;
            background: white;
            border-radius: var(--border-radius);
            padding: 1rem 1.5rem;
            box-shadow: var(--shadow-lg);
            z-index: 1001;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            transform: translateX(400px);
            transition: var(--transition);
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.success {
            border-left: 4px solid var(--success);
        }

        .toast.error {
            border-left: 4px solid var(--error);
        }

        .toast.warning {
            border-left: 4px solid var(--warning);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .hero-title {
                font-size: 2.5rem;
            }

            .features-grid {
                grid-template-columns: 1fr;
            }

            .nav-content {
                flex-wrap: wrap;
            }

            .nav-item {
                flex: 1;
                min-width: 100px;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .swipe-container {
                height: 500px;
            }

            .property-image {
                height: 250px;
            }

            .matches-grid {
                grid-template-columns: 1fr;
            }

            .properties-grid {
                grid-template-columns: 1fr;
            }

            .profile-header {
                flex-direction: column;
                text-align: center;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .account-tabs {
                flex-direction: column;
            }
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: var(--text-secondary);
        }

        .empty-state i {
            font-size: 4rem;
            margin-bottom: 1rem;
            color: var(--border-color);
        }

        .empty-state h3 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        .empty-state p {
            font-size: 1rem;
            max-width: 400px;
            margin: 0 auto;
        }

        /* Loading States */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid var(--border-color);
            border-top: 4px solid var(--wb-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Landing Page -->
    <div id="landingPage" class="landing-page">
        <div class="landing-container">
            <div class="logo-container">
                <div class="logo">
                    <i class="fas fa-home"></i>
                </div>
                <h1 class="hero-title">iFinder</h1>
                <p class="hero-subtitle">
                    A forma mais inteligente de encontrar seu imóvel ideal. 
                    Sistema de matching avançado para compra, venda e locação.
                </p>
                <button class="cta-button" onclick="showAuthModal('login')">
                    <i class="fas fa-rocket"></i> Começar Agora
                </button>
            </div>

            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-heart"></i>
                    </div>
                    <h3 class="feature-title">Sistema de Match</h3>
                    <p class="feature-description">
                        Algoritmo inteligente que encontra imóveis perfeitos para seu perfil
                    </p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-mobile-alt"></i>
                    </div>
                    <h3 class="feature-title">Interface Intuitiva</h3>
                    <p class="feature-description">
                        Navegue pelos imóveis com gestos simples, como em redes sociais
                    </p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <h3 class="feature-title">Seguro e Confiável</h3>
                    <p class="feature-description">
                        Todos os imóveis são verificados e os proprietários autenticados
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Auth Modal -->
    <div id="authModal" class="modal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeAuthModal()">
                <i class="fas fa-times"></i>
            </button>
            
            <!-- Login Form -->
            <div id="loginForm" class="auth-form">
                <div class="modal-header">
                    <h2 class="modal-title">Entrar no iFinder</h2>
                    <p class="modal-subtitle">Acesse sua conta para continuar</p>
                </div>
                
                <form onsubmit="handleLogin(event)">
                    <div class="form-group">
                        <label class="form-label">Email</label>
                        <input type="email" class="form-input" id="loginEmail" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Senha</label>
                        <input type="password" class="form-input" id="loginPassword" required>
                    </div>
                    
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-sign-in-alt"></i> Entrar
                    </button>
                </form>
                
                <button class="btn-secondary" onclick="showAuthModal('register')">
                    Não tem conta? Cadastre-se
                </button>
            </div>
            
            <!-- Register Form -->
            <div id="registerForm" class="auth-form" style="display: none;">
                <div class="modal-header">
                    <h2 class="modal-title">Criar Conta</h2>
                    <p class="modal-subtitle">Cadastre-se para começar a usar o iFinder</p>
                </div>
                
                <form onsubmit="handleRegister(event)">
                    <div class="form-group">
                        <label class="form-label">Nome Completo</label>
                        <input type="text" class="form-input" id="registerName" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Email</label>
                        <input type="email" class="form-input" id="registerEmail" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Telefone</label>
                        <input type="tel" class="form-input" id="registerPhone" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">CPF</label>
                        <input type="text" class="form-input" id="registerCPF" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Tipo de Usuário</label>
                        <select class="form-select" id="registerUserType" required>
                            <option value="">Selecione...</option>
                            <option value="interessado">Interessado(a) - Busco imóveis</option>
                            <option value="proprietario">Proprietário(a) - Tenho imóveis</option>
                            <option value="corretor">Corretor(a) - Trabalho com vendas</option>
                            <option value="captador">Captador(a) - Busco oportunidades</option>
                            <option value="outros">Outros - Profissional do setor</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Senha</label>
                        <input type="password" class="form-input" id="registerPassword" required>
                    </div>
                    
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-user-plus"></i> Criar Conta
                    </button>
                </form>
                
                <button class="btn-secondary" onclick="showAuthModal('login')">
                    Já tem conta? Faça login
                </button>
            </div>
        </div>
    </div>

    <!-- Property Modal -->
    <div id="propertyModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <button class="close-modal" onclick="closePropertyModal()">
                <i class="fas fa-times"></i>
            </button>
            
            <div class="modal-header">
                <h2 class="modal-title" id="propertyModalTitle">Cadastrar Imóvel</h2>
                <p class="modal-subtitle">Preencha as informações do seu imóvel</p>
            </div>
            
            <form id="propertyForm" onsubmit="handlePropertySubmit(event)">
                <input type="hidden" id="propertyId">
                
                <div class="form-section">
                    <h3 class="section-title">
                        <i class="fas fa-info-circle"></i> Informações Básicas
                    </h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Título do Anúncio</label>
                            <input type="text" class="form-input" id="propertyTitle" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Tipo de Imóvel</label>
                            <select class="form-select" id="propertyType" required>
                                <option value="">Selecione...</option>
                                <option value="casa">Casa</option>
                                <option value="apartamento">Apartamento</option>
                                <option value="comercial">Comercial</option>
                                <option value="terreno">Terreno</option>
                                <option value="chacara">Chácara</option>
                                <option value="sitio">Sítio</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Finalidade</label>
                            <select class="form-select" id="propertyPurpose" required>
                                <option value="">Selecione...</option>
                                <option value="venda">Venda</option>
                                <option value="locacao">Locação</option>
                                <option value="ambos">Venda e Locação</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h3 class="section-title">
                        <i class="fas fa-map-marker-alt"></i> Localização
                    </h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">CEP</label>
                            <input type="text" class="form-input" id="propertyCEP" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Estado</label>
                            <select class="form-select" id="propertyState" required>
                                <option value="">Selecione...</option>
                                <option value="SP">São Paulo</option>
                                <option value="RJ">Rio de Janeiro</option>
                                <option value="MG">Minas Gerais</option>
                                <option value="RS">Rio Grande do Sul</option>
                                <option value="PR">Paraná</option>
                                <option value="SC">Santa Catarina</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Cidade</label>
                            <input type="text" class="form-input" id="propertyCity" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Bairro</label>
                            <input type="text" class="form-input" id="propertyNeighborhood" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Endereço Completo</label>
                        <input type="text" class="form-input" id="propertyAddress" required>
                    </div>
                </div>

                <div class="form-section">
                    <h3 class="section-title">
                        <i class="fas fa-ruler-combined"></i> Características
                    </h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Quartos</label>
                            <select class="form-select" id="propertyBedrooms">
                                <option value="">Selecione...</option>
                                <option value="0">Studio</option>
                                <option value="1">1 quarto</option>
                                <option value="2">2 quartos</option>
                                <option value="3">3 quartos</option>
                                <option value="4">4 quartos</option>
                                <option value="5">5+ quartos</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Banheiros</label>
                            <select class="form-select" id="propertyBathrooms">
                                <option value="">Selecione...</option>
                                <option value="1">1 banheiro</option>
                                <option value="2">2 banheiros</option>
                                <option value="3">3 banheiros</option>
                                <option value="4">4+ banheiros</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Área (m²)</label>
                            <input type="number" class="form-input" id="propertyArea" min="1">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Vagas de Garagem</label>
                            <select class="form-select" id="propertyGarage">
                                <option value="">Selecione...</option>
                                <option value="0">Sem garagem</option>
                                <option value="1">1 vaga</option>
                                <option value="2">2 vagas</option>
                                <option value="3">3 vagas</option>
                                <option value="4">4+ vagas</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h3 class="section-title">
                        <i class="fas fa-dollar-sign"></i> Valores
                    </h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Preço</label>
                            <input type="text" class="form-input" id="propertyPrice" placeholder="R$ 0,00" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Condomínio</label>
                            <input type="text" class="form-input" id="propertyCondo" placeholder="R$ 0,00">
                        </div>
                        <div class="form-group">
                            <label class="form-label">IPTU</label>
                            <input type="text" class="form-input" id="propertyIPTU" placeholder="R$ 0,00">
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h3 class="section-title">
                        <i class="fas fa-align-left"></i> Descrição
                    </h3>
                    <div class="form-group">
                        <label class="form-label">Descrição Detalhada</label>
                        <textarea class="form-textarea" id="propertyDescription" placeholder="Descreva as características e diferenciais do imóvel..." required></textarea>
                    </div>
                </div>

                <div class="form-section">
                    <h3 class="section-title">
                        <i class="fas fa-images"></i> Fotos
                    </h3>
                    <div class="form-group">
                        <div class="file-upload">
                            <input type="file" id="propertyImages" multiple accept="image/*" onchange="handleImageUpload(event)">
                            <div class="file-upload-label">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <span>Clique para adicionar fotos (máximo 10)</span>
                            </div>
                        </div>
                        <div id="imageGallery" class="image-gallery"></div>
                    </div>
                </div>

                <button type="submit" class="btn-primary">
                    <i class="fas fa-save"></i> <span id="propertySubmitText">Cadastrar Imóvel</span>
                </button>
            </form>
        </div>
    </div>

    <!-- App Container -->
    <div id="appContainer" class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="header-content">
                <div class="header-logo">
                    <div class="header-logo-icon">
                        <i class="fas fa-home"></i>
                    </div>
                    <span class="header-logo-text">iFinder</span>
                </div>
                
                <div class="user-info">
                    <div class="user-avatar" id="userAvatar" onclick="showSection('account')">U</div>
                    <span class="user-name" id="userName">Usuário</span>
                    <button class="logout-btn" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="app-nav">
            <div class="nav-content">
                <div class="nav-item active" onclick="showSection('dashboard')">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Início</span>
                </div>
                <div class="nav-item" onclick="showSection('search')">
                    <i class="fas fa-search"></i>
                    <span>Buscar</span>
                </div>
                <div class="nav-item" onclick="showSection('matches')">
                    <i class="fas fa-heart"></i>
                    <span>Matches</span>
                </div>
                <div class="nav-item" onclick="showSection('cadastrar')">
                    <i class="fas fa-plus"></i>
                    <span>Cadastrar</span>
                </div>
                <div class="nav-item" onclick="showSection('account')">
                    <i class="fas fa-user-cog"></i>
                    <span>Conta</span>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="app-main">
            <!-- Dashboard Section -->
            <section id="dashboard" class="section active">
                <div class="dashboard-grid">
                    <div class="stat-card" onclick="navigateToSection('search')" style="cursor: pointer;">
                        <div class="stat-header">
                            <span class="stat-title">Imóveis Vistos</span>
                            <div class="stat-icon">
                                <i class="fas fa-eye"></i>
                            </div>
                        </div>
                        <div class="stat-value" id="viewedCount">0</div>
                        <div class="stat-description">Total de imóveis visualizados</div>
                    </div>
                    
                    <div class="stat-card" onclick="navigateToSection('matches')" style="cursor: pointer;">
                        <div class="stat-header">
                            <span class="stat-title">Matches</span>
                            <div class="stat-icon">
                                <i class="fas fa-heart"></i>
                            </div>
                        </div>
                        <div class="stat-value" id="matchCount">0</div>
                        <div class="stat-description">Imóveis que você curtiu</div>
                    </div>
                    
                    <div class="stat-card" onclick="navigateToAccountTab('properties')" style="cursor: pointer;">
                        <div class="stat-header">
                            <span class="stat-title">Meus Imóveis</span>
                            <div class="stat-icon">
                                <i class="fas fa-home"></i>
                            </div>
                        </div>
                        <div class="stat-value" id="myPropertiesCount">0</div>
                        <div class="stat-description">Imóveis cadastrados por você</div>
                    </div>
                    
                    <div class="stat-card" onclick="showPropertyViewsDetails()" style="cursor: pointer;">
                        <div class="stat-header">
                            <span class="stat-title">Visualizações</span>
                            <div class="stat-icon">
                                <i class="fas fa-chart-line"></i>
                            </div>
                        </div>
                        <div class="stat-value" id="propertyViewsCount">0</div>
                        <div class="stat-description">Visualizações dos seus imóveis</div>
                    </div>
                </div>
                
                <div class="profile-card">
                    <h3 style="margin-bottom: 1rem; color: var(--wb-blue);">
                        <i class="fas fa-chart-line"></i> Atividade Recente
                    </h3>
                    <div id="recentActivity">
                        <!-- Recent activities will be loaded here -->
                    </div>
                </div>
            </section>

            <!-- Search Section -->
            <section id="search" class="section">
                <div class="filters">
                    <button class="filter-btn active" onclick="filterProperties('todos')">
                        <i class="fas fa-th"></i> Todos
                    </button>
                    <button class="filter-btn" onclick="filterProperties('casa')">
                        <i class="fas fa-home"></i> Casas
                    </button>
                    <button class="filter-btn" onclick="filterProperties('apartamento')">
                        <i class="fas fa-building"></i> Apartamentos
                    </button>
                    <button class="filter-btn" onclick="filterProperties('comercial')">
                        <i class="fas fa-store"></i> Comercial
                    </button>
            <!-- Search Section -->
            <section id="search" class="section">
                <!-- Search and Filter Section -->
                <div class="search-section">
                    <div class="search-tabs">
                        <button class="search-tab active" onclick="switchSearchTab('properties')">
                            <i class="fas fa-home"></i> Buscar Imóveis
                        </button>
                        <button class="search-tab" onclick="switchSearchTab('users')">
                            <i class="fas fa-users"></i> Buscar Usuários
                        </button>
                    </div>

                    <!-- Property Search -->
                    <div class="search-content active" id="propertySearch">
                        <div class="search-bar">
                            <i class="fas fa-search search-icon"></i>
                            <input type="text" class="search-input" id="propertySearchInput" 
                                   placeholder="Busque por localização, título ou descrição..." 
                                   oninput="searchProperties()">
                        </div>

                        <div class="filters-grid">
                            <div class="filter-group">
                                <label class="filter-label">Tipo de Imóvel</label>
                                <select class="filter-select" id="typeFilter" onchange="applyFilters()">
                                    <option value="">Todos os tipos</option>
                                    <option value="casa">Casa</option>
                                    <option value="apartamento">Apartamento</option>
                                    <option value="comercial">Comercial</option>
                                    <option value="terreno">Terreno</option>
                                    <option value="chacara">Chácara</option>
                                    <option value="sitio">Sítio</option>
                                </select>
                            </div>

                            <div class="filter-group">
                                <label class="filter-label">Quartos</label>
                                <select class="filter-select" id="bedroomsFilter" onchange="applyFilters()">
                                    <option value="">Qualquer quantidade</option>
                                    <option value="1">1 quarto</option>
                                    <option value="2">2 quartos</option>
                                    <option value="3">3 quartos</option>
                                    <option value="4">4+ quartos</option>
                                </select>
                            </div>

                            <div class="filter-group">
                                <label class="filter-label">Banheiros</label>
                                <select class="filter-select" id="bathroomsFilter" onchange="applyFilters()">
                                    <option value="">Qualquer quantidade</option>
                                    <option value="1">1 banheiro</option>
                                    <option value="2">2 banheiros</option>
                                    <option value="3">3+ banheiros</option>
                                </select>
                            </div>

                            <div class="filter-group">
                                <label class="filter-label">Localização</label>
                                <select class="filter-select" id="locationFilter" onchange="applyFilters()">
                                    <option value="">Todas as cidades</option>
                                    <option value="São Paulo">São Paulo - SP</option>
                                    <option value="Rio de Janeiro">Rio de Janeiro - RJ</option>
                                    <option value="Campos do Jordão">Campos do Jordão - SP</option>
                                    <option value="Barueri">Barueri - SP</option>
                                </select>
                            </div>

                            <div class="filter-group">
                                <label class="filter-label">Faixa de Preço</label>
                                <div class="price-range">
                                    <input type="text" class="price-input" id="minPrice" placeholder="Mín" oninput="formatPriceInput(this)" onchange="applyFilters()">
                                    <span class="price-separator">até</span>
                                    <input type="text" class="price-input" id="maxPrice" placeholder="Máx" oninput="formatPriceInput(this)" onchange="applyFilters()">
                                </div>
                            </div>

                            <div class="filter-group">
                                <label class="filter-label">Área (m²)</label>
                                <select class="filter-select" id="areaFilter" onchange="applyFilters()">
                                    <option value="">Qualquer área</option>
                                    <option value="0-50">Até 50m²</option>
                                    <option value="50-100">50m² - 100m²</option>
                                    <option value="100-200">100m² - 200m²</option>
                                    <option value="200+">Acima de 200m²</option>
                                </select>
                            </div>
                        </div>

                        <div class="filter-actions">
                            <button class="filter-btn secondary" onclick="clearFilters()">
                                <i class="fas fa-times"></i> Limpar Filtros
                            </button>
                            <button class="filter-btn primary" onclick="applyFilters()">
                                <i class="fas fa-search"></i> Buscar
                            </button>
                        </div>
                    </div>

                    <!-- User Search -->
                    <div class="search-content" id="userSearch">
                        <div class="search-bar">
                            <i class="fas fa-search search-icon"></i>
                            <input type="text" class="search-input" id="userSearchInput" 
                                   placeholder="Busque por nome, email ou tipo de usuário..." 
                                   oninput="searchUsers()">
                        </div>

                        <div class="filters-grid">
                            <div class="filter-group">
                                <label class="filter-label">Tipo de Usuário</label>
                                <select class="filter-select" id="userTypeFilter" onchange="searchUsers()">
                                    <option value="">Todos os tipos</option>
                                    <option value="interessado">Interessado</option>
                                    <option value="proprietario">Proprietário</option>
                                    <option value="corretor">Corretor</option>
                                    <option value="captador">Captador</option>
                                    <option value="outros">Outros</option>
                                </select>
                            </div>

                            <div class="filter-group">
                                <label class="filter-label">Ordenar por</label>
                                <select class="filter-select" id="userSortFilter" onchange="searchUsers()">
                                    <option value="name">Nome</option>
                                    <option value="recent">Mais recentes</option>
                                    <option value="properties">Mais imóveis</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Search Results -->
                <div class="search-results">
                    <div class="results-header" id="resultsHeader" style="display: none;">
                        <div class="results-count" id="resultsCount"></div>
                        <select class="sort-select" id="sortSelect" onchange="sortResults()">
                            <option value="relevance">Mais relevantes</option>
                            <option value="price-asc">Menor preço</option>
                            <option value="price-desc">Maior preço</option>
                            <option value="area-desc">Maior área</option>
                            <option value="recent">Mais recentes</option>
                        </select>
                    </div>

                    <div id="searchResultsContainer">
                        <!-- Results will be loaded here -->
                    </div>
                </div>

                <!-- Swipe Container (Original) -->
                <div class="swipe-container" id="swipeContainer">
                    <div class="swipe-actions">
                        <button class="action-btn reject" onclick="rejectProperty()">
                            <i class="fas fa-times"></i>
                        </button>
                        <button class="action-btn super-like" onclick="superLikeProperty()">
                            <i class="fas fa-star"></i>
                        </button>
                        <button class="action-btn like" onclick="likeProperty()">
                            <i class="fas fa-heart"></i>
                        </button>
                    </div>
                </div>
            </section><!-- Matches Section -->
            <section id="matches" class="section">
                <div class="matches-header">
                    <div>
                        <h2 style="margin: 0; color: var(--wb-blue);">
                            <i class="fas fa-heart"></i> Seus Matches
                        </h2>
                        <p style="margin: 0.5rem 0 0 0; color: var(--text-secondary);">
                            Imóveis que você curtiu
                        </p>
                    </div>
                    
                    <div class="matches-view-toggle">
                        <button class="view-toggle-btn active" onclick="switchMatchesView('list')">
                            <i class="fas fa-list"></i> Lista
                        </button>
                        <button class="view-toggle-btn" onclick="switchMatchesView('map')">
                            <i class="fas fa-map"></i> Mapa
                        </button>
                    </div>
                </div>

                <div class="matches-content">
                    <!-- List View -->
                    <div class="matches-list-view active" id="matchesListView">
                        <div class="matches-grid" id="matchesContainer">
                            <!-- Matches will be loaded here -->
                        </div>
                    </div>

                    <!-- Map View -->
                    <div class="matches-map-view" id="matchesMapView">
                        <div class="map-container">
                            <div id="matchesMap"></div>
                            
                            <div class="map-controls">
                                <button class="map-control-btn" onclick="centerMapOnMatches()" title="Centralizar no Brasil">
                                    <i class="fas fa-crosshairs"></i>
                                </button>
                                <button class="map-control-btn" onclick="toggleMapLayer()" title="Alternar camada do mapa">
                                    <i class="fas fa-layer-group"></i>
                                </button>
                            </div>

                            <div class="map-info-panel" id="mapInfoPanel">
                                <div class="map-info-header">
                                    <div>
                                        <h4 class="map-info-title" id="mapInfoTitle"></h4>
                                        <div class="map-info-price" id="mapInfoPrice"></div>
                                    </div>
                                    <button class="close-map-info" onclick="closeMapInfo()">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                                
                                <div class="map-info-location" id="mapInfoLocation">
                                    <i class="fas fa-map-marker-alt"></i>
                                    <span></span>
                                </div>
                                
                                <div class="map-info-features" id="mapInfoFeatures">
                                    <!-- Features will be loaded here -->
                                </div>
                                
                                <div class="map-info-actions">
                                    <button class="map-info-btn primary" onclick="contactPropertyFromMap()">
                                        <i class="fas fa-phone"></i> Contatar
                                    </button>
                                    <button class="map-info-btn secondary" onclick="viewPropertyDetails()">
                                        <i class="fas fa-eye"></i> Ver Detalhes
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Cadastrar Section -->
            <section id="cadastrar" class="section">
                <div class="profile-card">
                    <h2 style="margin-bottom: 2rem; color: var(--wb-blue);">
                        <i class="fas fa-plus"></i> Cadastrar Imóvel
                    </h2>
                    <p style="color: var(--text-secondary); margin-bottom: 2rem;">
                        Cadastre seus imóveis e alcance milhares de interessados. Todos os tipos de usuários podem cadastrar imóveis no iFinder.
                    </p>
                    
                    <button class="btn-primary" onclick="showPropertyModal()" style="width: auto; padding: 1rem 2rem;">
                        <i class="fas fa-plus"></i> Novo Imóvel
                    </button>
                </div>
            </section>

            <!-- Account Section -->
            <section id="account" class="section">
                <div class="account-tabs">
                    <button class="account-tab active" onclick="showAccountTab('profile')">
                        <i class="fas fa-user"></i>
                        <span>Perfil</span>
                    </button>
                    <button class="account-tab" onclick="showAccountTab('properties')">
                        <i class="fas fa-home"></i>
                        <span>Meus Imóveis</span>
                    </button>
                    <button class="account-tab" onclick="showAccountTab('settings')">
                        <i class="fas fa-cog"></i>
                        <span>Configurações</span>
                    </button>
                </div>

                <!-- Profile Tab -->
                <div id="profileTab" class="account-content active">
                    <div class="profile-card">
                        <div class="profile-header">
                            <div class="profile-avatar" id="profileAvatar" onclick="changeProfilePicture()">U</div>
                            <div class="profile-info">
                                <h2 id="profileName">Nome do Usuário</h2>
                                <p id="profileType">Tipo de usuário</p>
                                <button class="btn-edit" onclick="editProfile()">
                                    <i class="fas fa-edit"></i> Editar Perfil
                                </button>
                            </div>
                        </div>
                        
                        <div class="profile-details">
                            <div class="detail-item">
                                <div class="detail-icon">
                                    <i class="fas fa-envelope"></i>
                                </div>
                                <div class="detail-content">
                                    <h4>Email</h4>
                                    <p id="profileEmail">email@exemplo.com</p>
                                </div>
                            </div>
                            
                            <div class="detail-item">
                                <div class="detail-icon">
                                    <i class="fas fa-phone"></i>
                                </div>
                                <div class="detail-content">
                                    <h4>Telefone</h4>
                                    <p id="profilePhone">(11) 99999-9999</p>
                                </div>
                            </div>
                            
                            <div class="detail-item">
                                <div class="detail-icon">
                                    <i class="fas fa-id-card"></i>
                                </div>
                                <div class="detail-content">
                                    <h4>CPF</h4>
                                    <p id="profileCPF">***.***.***-**</p>
                                </div>
                            </div>
                            
                            <div class="detail-item">
                                <div class="detail-icon">
                                    <i class="fas fa-calendar"></i>
                                </div>
                                <div class="detail-content">
                                    <h4>Membro desde</h4>
                                    <p id="profileSince">Janeiro 2024</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Properties Tab -->
                <div id="propertiesTab" class="account-content">
                    <div class="profile-card">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                            <h2 style="color: var(--wb-blue);">
                                <i class="fas fa-home"></i> Meus Imóveis
                            </h2>
                            <button class="btn-primary" onclick="showPropertyModal()" style="width: auto; padding: 0.75rem 1.5rem;">
                                <i class="fas fa-plus"></i> Novo Imóvel
                            </button>
                        </div>
                        
                        <div class="properties-grid" id="myPropertiesGrid">
                            <!-- User properties will be dynamically inserted here -->
                        </div>
                    </div>
                </div>

                <!-- Settings Tab -->
                <div id="settingsTab" class="account-content">
                    <div class="profile-card">
                        <h2 style="margin-bottom: 2rem; color: var(--wb-blue);">
                            <i class="fas fa-cog"></i> Configurações
                        </h2>
                        
                        <form onsubmit="handleSettingsUpdate(event)">
                            <div class="form-section">
                                <h3 class="section-title">
                                    <i class="fas fa-user"></i> Informações Pessoais
                                </h3>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label class="form-label">Nome Completo</label>
                                        <input type="text" class="form-input" id="settingsName" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Apelido/Nome de Exibição</label>
                                        <input type="text" class="form-input" id="settingsNickname" placeholder="Como você quer ser chamado">
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label class="form-label">Email</label>
                                        <input type="email" class="form-input" id="settingsEmail" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Telefone</label>
                                        <input type="tel" class="form-input" id="settingsPhone" required>
                                    </div>
                                </div>
                            </div>

                            <div class="form-section">
                                <h3 class="section-title">
                                    <i class="fas fa-bell"></i> Notificações
                                </h3>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                        <input type="checkbox" id="notifyMatches" checked>
                                        <span>Receber notificações de novos matches</span>
                                    </label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                        <input type="checkbox" id="notifyMessages" checked>
                                        <span>Receber notificações de mensagens</span>
                                    </label>
                                </div>
                                <div class="form-group">
                                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                        <input type="checkbox" id="notifyNewProperties" checked>
                                        <span>Receber notificações de novos imóveis</span>
                                    </label>
                                </div>
                            </div>

                            <div class="form-section">
                                <h3 class="section-title">
                                    <i class="fas fa-lock"></i> Segurança
                                </h3>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label class="form-label">Nova Senha</label>
                                        <input type="password" class="form-input" id="newPassword" placeholder="Deixe em branco para manter a atual">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Confirmar Nova Senha</label>
                                        <input type="password" class="form-input" id="confirmPassword" placeholder="Confirme a nova senha">
                                    </div>
                                </div>
                            </div>

                            <button type="submit" class="btn-primary">
                                <i class="fas fa-save"></i> Salvar Configurações
                            </button>
                        </form>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Match Modal -->
    <div id="matchModal" class="modal">
        <div class="modal-content" style="text-align: center; max-width: 400px;">
            <h2 style="color: var(--success); margin-bottom: 1rem;">
                <i class="fas fa-heart" style="font-size: 3rem; margin-bottom: 1rem; display: block;"></i>
                É um Match!
            </h2>
            <p style="margin-bottom: 2rem; color: var(--text-secondary);">
                Você curtiu este imóvel! Ele foi adicionado aos seus matches.
            </p>
            <button class="btn-primary" onclick="closeMatchModal()">
                <i class="fas fa-check"></i> Continuar Buscando
            </button>
        </div>
    </div>

    <!-- Profile Picture Upload -->
    <input type="file" id="profilePictureInput" accept="image/*" style="display: none;" onchange="handleProfilePictureUpload(event)">

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <script>
        // Global Variables
        let currentUser = null;
        let currentPropertyIndex = 0;
        let properties = [];
        let matches = [];
        let viewedProperties = [];
        let userProperties = [];
        let isDragging = false;
        let startX = 0;
        let startY = 0;
        let currentX = 0;
        let currentY = 0;
        let currentEditingProperty = null;
        let uploadedImages = [];
        
        // Integration System Variables
        let globalProperties = []; // Shared properties across all users
        let propertyViews = {}; // Track property views by property ID
        let propertyLikes = {}; // Track property likes by property ID
        let userActivity = []; // Track user activities for real-time updates
        let lastSyncTime = 0; // For real-time synchronization
        let syncInterval = null; // Interval for auto-sync
        
        // Map Variables
        let matchesMap = null;
        let mapMarkers = [];
        let currentMapLayer = 'street';
        let selectedPropertyId = null;

        // Property Data
        const propertyData = [
            {
                id: 1,
                title: "Casa Moderna em Condomínio",
                price: "R$ 850.000",
                location: "Alphaville, Barueri - SP",
                type: "casa",
                bedrooms: 3,
                bathrooms: 2,
                area: 180,
                image: "https://images.unsplash.com/photo-1600596542815-ffad4c1539a9?w=400&h=300&fit=crop",
                description: "Linda casa em condomínio fechado com área de lazer completa.",
                coordinates: [-23.5505, -46.6333], // São Paulo coordinates
                ownerId: null
            },
            {
                id: 2,
                title: "Apartamento com Vista para o Mar",
                price: "R$ 1.200.000",
                location: "Copacabana, Rio de Janeiro - RJ",
                type: "apartamento",
                bedrooms: 2,
                bathrooms: 2,
                area: 95,
                image: "https://images.unsplash.com/photo-1502672260266-1c1ef2d93688?w=400&h=300&fit=crop",
                description: "Apartamento com vista deslumbrante para a praia de Copacabana.",
                coordinates: [-22.9068, -43.1729], // Rio de Janeiro coordinates
                ownerId: null
            },
            {
                id: 3,
                title: "Loja Comercial no Centro",
                price: "R$ 450.000",
                location: "Centro, São Paulo - SP",
                type: "comercial",
                bedrooms: 0,
                bathrooms: 1,
                area: 120,
                image: "https://images.unsplash.com/photo-1441986300917-64674bd600d8?w=400&h=300&fit=crop",
                description: "Excelente ponto comercial em região de grande movimento.",
                coordinates: [-23.5475, -46.6361], // Centro de São Paulo
                ownerId: null
            },
            {
                id: 4,
                title: "Casa de Campo Aconchegante",
                price: "R$ 650.000",
                location: "Campos do Jordão - SP",
                type: "casa",
                bedrooms: 3,
                bathrooms: 2,
                area: 200,
                image: "https://images.unsplash.com/photo-1449824913935-59a10b8d2000?w=400&h=300&fit=crop",
                description: "Casa rústica em meio à natureza, perfeita para relaxar.",
                coordinates: [-22.7394, -45.5919], // Campos do Jordão
                ownerId: null
            },
            {
                id: 5,
                title: "Cobertura Duplex Premium",
                price: "R$ 2.500.000",
                location: "Jardins, São Paulo - SP",
                type: "apartamento",
                bedrooms: 4,
                bathrooms: 3,
                area: 250,
                image: "https://images.unsplash.com/photo-1512917774080-9991f1c4c750?w=400&h=300&fit=crop",
                description: "Cobertura duplex com terraço gourmet e piscina privativa.",
                coordinates: [-23.5629, -46.6544], // Jardins, São Paulo
                ownerId: null
            },
            {
                id: 6,
                title: "Apartamento Familiar Completo",
                price: "R$ 480.000",
                location: "Tijuca, Rio de Janeiro - RJ",
                type: "apartamento",
                bedrooms: 3,
                bathrooms: 2,
                area: 110,
                image: "https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?w=400&h=300&fit=crop",
                description: "Apartamento espaçoso em bairro tradicional do Rio de Janeiro.",
                coordinates: [-22.9249, -43.2311], // Tijuca
                ownerId: null
            },
            {
                id: 7,
                title: "Casa com Piscina e Churrasqueira",
                price: "R$ 920.000",
                location: "Barra da Tijuca, Rio de Janeiro - RJ",
                type: "casa",
                bedrooms: 4,
                bathrooms: 3,
                area: 280,
                image: "https://images.unsplash.com/photo-1613977257363-707ba9348227?w=400&h=300&fit=crop",
                description: "Casa ampla com área de lazer completa e quintal espaçoso.",
                coordinates: [-23.0129, -43.3203], // Barra da Tijuca
                ownerId: null
            },
            {
                id: 8,
                title: "Studio Compacto e Funcional",
                price: "R$ 320.000",
                location: "Centro, São Paulo - SP",
                type: "apartamento",
                bedrooms: 1,
                bathrooms: 1,
                area: 35,
                image: "https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?w=400&h=300&fit=crop",
                description: "Studio moderno e bem localizado no centro da cidade.",
                coordinates: [-23.5475, -46.6361], // Centro de São Paulo
                ownerId: null
            }
        ];

        // Initialize App
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            // Check if user is logged in
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                showApp();
            } else {
                showLandingPage();
            }

            // Load saved data
            loadSavedData();
            
            // Initialize integration system
            initializeIntegrationSystem();
            
            // Initialize properties
            properties = [...propertyData];
            
            // Setup swipe functionality
            setupSwipeContainer();
            
            // Start real-time sync
            startRealTimeSync();
        }

        // Integration System Functions
        function initializeIntegrationSystem() {
            // Load global properties from localStorage
            const savedGlobalProperties = localStorage.getItem('globalProperties');
            if (savedGlobalProperties) {
                globalProperties = JSON.parse(savedGlobalProperties);
            } else {
                // Initialize with default properties
                globalProperties = [...propertyData];
                saveGlobalProperties();
            }

            // Load property views and likes
            const savedViews = localStorage.getItem('propertyViews');
            const savedLikes = localStorage.getItem('propertyLikes');
            const savedActivity = localStorage.getItem('userActivity');

            if (savedViews) propertyViews = JSON.parse(savedViews);
            if (savedLikes) propertyLikes = JSON.parse(savedLikes);
            if (savedActivity) userActivity = JSON.parse(savedActivity);

            // Merge global properties with local properties
            mergeGlobalProperties();
        }

        function mergeGlobalProperties() {
            // Merge global properties with local properties array
            globalProperties.forEach(globalProp => {
                const existingIndex = properties.findIndex(p => p.id === globalProp.id);
                if (existingIndex !== -1) {
                    // Update existing property with global data
                    properties[existingIndex] = { ...properties[existingIndex], ...globalProp };
                } else {
                    // Add new global property
                    properties.push(globalProp);
                }
            });

            // Update property views and likes counts
            properties.forEach(property => {
                property.viewCount = propertyViews[property.id] || 0;
                property.likeCount = propertyLikes[property.id] || 0;
            });
        }

        function saveGlobalProperties() {
            localStorage.setItem('globalProperties', JSON.stringify(globalProperties));
        }

        function saveIntegrationData() {
            localStorage.setItem('propertyViews', JSON.stringify(propertyViews));
            localStorage.setItem('propertyLikes', JSON.stringify(propertyLikes));
            localStorage.setItem('userActivity', JSON.stringify(userActivity));
        }

        function addUserActivity(type, data) {
            const activity = {
                id: Date.now(),
                userId: currentUser.id,
                userName: currentUser.name,
                type: type, // 'property_added', 'property_viewed', 'property_liked', 'user_registered'
                data: data,
                timestamp: new Date().toISOString()
            };

            userActivity.unshift(activity);
            
            // Keep only last 100 activities
            if (userActivity.length > 100) {
                userActivity = userActivity.slice(0, 100);
            }

            saveIntegrationData();
            
            // Broadcast activity to other users (simulated)
            broadcastActivity(activity);
        }

        function broadcastActivity(activity) {
            // In a real app, this would use WebSockets or Server-Sent Events
            // For now, we'll simulate by updating localStorage with a timestamp
            localStorage.setItem('lastActivityBroadcast', JSON.stringify({
                activity: activity,
                timestamp: Date.now()
            }));
        }

        function startRealTimeSync() {
            // Check for updates every 3 seconds
            syncInterval = setInterval(() => {
                checkForUpdates();
            }, 3000);
        }

        function checkForUpdates() {
            const lastBroadcast = localStorage.getItem('lastActivityBroadcast');
            if (lastBroadcast) {
                const broadcast = JSON.parse(lastBroadcast);
                
                // Only process if it's newer than our last sync and not from current user
                if (broadcast.timestamp > lastSyncTime && broadcast.activity.userId !== currentUser?.id) {
                    processRemoteActivity(broadcast.activity);
                    lastSyncTime = broadcast.timestamp;
                }
            }

            // Reload global properties if they've been updated
            const savedGlobalProperties = localStorage.getItem('globalProperties');
            if (savedGlobalProperties) {
                const newGlobalProperties = JSON.parse(savedGlobalProperties);
                if (JSON.stringify(newGlobalProperties) !== JSON.stringify(globalProperties)) {
                    globalProperties = newGlobalProperties;
                    mergeGlobalProperties();
                    
                    // Refresh current view if needed
                    if (document.getElementById('search').classList.contains('active')) {
                        loadCurrentProperty();
                    }
                    
                    updateDashboardStats();
                }
            }
        }

        function processRemoteActivity(activity) {
            switch (activity.type) {
                case 'property_added':
                    handleRemotePropertyAdded(activity);
                    break;
                case 'property_viewed':
                    handleRemotePropertyViewed(activity);
                    break;
                case 'property_liked':
                    handleRemotePropertyLiked(activity);
                    break;
                case 'user_registered':
                    handleRemoteUserRegistered(activity);
                    break;
            }
        }

        function handleRemotePropertyAdded(activity) {
            const newProperty = activity.data;
            
            // Add to global properties if not exists
            if (!globalProperties.find(p => p.id === newProperty.id)) {
                globalProperties.push(newProperty);
                saveGlobalProperties();
            }

            // Add to local properties if not exists
            if (!properties.find(p => p.id === newProperty.id)) {
                properties.push(newProperty);
            }

            // Show notification
            if (currentUser && activity.userId !== currentUser.id) {
                showToast(`Novo imóvel adicionado por ${activity.userName}!`, 'success');
            }
        }

        function handleRemotePropertyViewed(activity) {
            const propertyId = activity.data.propertyId;
            propertyViews[propertyId] = (propertyViews[propertyId] || 0) + 1;
            saveIntegrationData();
            
            // Update property in arrays
            updatePropertyStats(propertyId);
        }

        function handleRemotePropertyLiked(activity) {
            const propertyId = activity.data.propertyId;
            propertyLikes[propertyId] = (propertyLikes[propertyId] || 0) + 1;
            saveIntegrationData();
            
            // Update property in arrays
            updatePropertyStats(propertyId);
        }

        function handleRemoteUserRegistered(activity) {
            if (currentUser && activity.userId !== currentUser.id) {
                showToast(`${activity.userName} se juntou ao iFinder!`, 'success');
            }
        }

        function updatePropertyStats(propertyId) {
            // Update in properties array
            const propertyIndex = properties.findIndex(p => p.id === propertyId);
            if (propertyIndex !== -1) {
                properties[propertyIndex].viewCount = propertyViews[propertyId] || 0;
                properties[propertyIndex].likeCount = propertyLikes[propertyId] || 0;
            }

            // Update in global properties
            const globalIndex = globalProperties.findIndex(p => p.id === propertyId);
            if (globalIndex !== -1) {
                globalProperties[globalIndex].viewCount = propertyViews[propertyId] || 0;
                globalProperties[globalIndex].likeCount = propertyLikes[propertyId] || 0;
                saveGlobalProperties();
            }
        }

        function loadSavedData() {
            const savedMatches = localStorage.getItem('matches');
            const savedViewed = localStorage.getItem('viewedProperties');
            const savedUserProperties = localStorage.getItem('userProperties');
            
            if (savedMatches) {
                matches = JSON.parse(savedMatches);
            }
            
            if (savedViewed) {
                viewedProperties = JSON.parse(savedViewed);
            }

            if (savedUserProperties) {
                userProperties = JSON.parse(savedUserProperties);
                // Add user properties to main properties array
                userProperties.forEach(prop => {
                    if (!properties.find(p => p.id === prop.id)) {
                        properties.push(prop);
                    }
                });
            }
        }

        function saveData() {
            localStorage.setItem('matches', JSON.stringify(matches));
            localStorage.setItem('viewedProperties', JSON.stringify(viewedProperties));
            localStorage.setItem('userProperties', JSON.stringify(userProperties));
        }

        // Auth Functions
        function showAuthModal(type) {
            const modal = document.getElementById('authModal');
            const loginForm = document.getElementById('loginForm');
            const registerForm = document.getElementById('registerForm');
            
            if (type === 'login') {
                loginForm.style.display = 'block';
                registerForm.style.display = 'none';
            } else {
                loginForm.style.display = 'none';
                registerForm.style.display = 'block';
            }
            
            modal.classList.add('active');
        }

        function closeAuthModal() {
            document.getElementById('authModal').classList.remove('active');
        }

        function handleLogin(event) {
            event.preventDefault();
            
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            // Get users from localStorage
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            const user = users.find(u => u.email === email && u.password === password);
            
            if (user) {
                currentUser = user;
                localStorage.setItem('currentUser', JSON.stringify(user));
                closeAuthModal();
                showApp();
                showToast('Login realizado com sucesso!', 'success');
            } else {
                showToast('Email ou senha incorretos!', 'error');
            }
        }

        function handleRegister(event) {
            event.preventDefault();
            
            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const phone = document.getElementById('registerPhone').value;
            const cpf = document.getElementById('registerCPF').value;
            const userType = document.getElementById('registerUserType').value;
            const password = document.getElementById('registerPassword').value;
            
            // Validate CPF
            if (!validateCPF(cpf)) {
                showToast('CPF inválido!', 'error');
                return;
            }
            
            // Get existing users
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            
            // Check if email already exists
            if (users.find(u => u.email === email)) {
                showToast('Este email já está cadastrado!', 'error');
                return;
            }
            
            // Create new user
            const newUser = {
                id: Date.now(),
                name,
                email,
                phone: formatPhone(phone),
                cpf: formatCPF(cpf),
                userType,
                password,
                nickname: name.split(' ')[0],
                profilePicture: null,
                createdAt: new Date().toISOString()
            };
            
            // Save user
            users.push(newUser);
            localStorage.setItem('users', JSON.stringify(users));
            
            // Auto login
            currentUser = newUser;
            localStorage.setItem('currentUser', JSON.stringify(newUser));
            
            // Add user registration activity
            addUserActivity('user_registered', {
                userId: newUser.id,
                userName: newUser.name,
                userType: newUser.userType
            });
            
            closeAuthModal();
            showApp();
            showToast('Conta criada com sucesso!', 'success');
        }

        function logout() {
            currentUser = null;
            localStorage.removeItem('currentUser');
            showLandingPage();
            showToast('Logout realizado com sucesso!', 'success');
        }

        // App Display Functions
        function showLandingPage() {
            document.getElementById('landingPage').style.display = 'flex';
            document.getElementById('appContainer').classList.remove('active');
        }

        function showApp() {
            document.getElementById('landingPage').style.display = 'none';
            document.getElementById('appContainer').classList.add('active');
            
            // Update user info in header
            updateUserInfo();
            
            // Load current property
            loadCurrentProperty();
            
            // Update dashboard stats
            updateDashboardStats();
            
            // Load matches
            loadMatches();

            // Load user properties
            loadUserProperties();
        }

        function updateUserInfo() {
            if (!currentUser) return;
            
            const userName = document.getElementById('userName');
            const userAvatar = document.getElementById('userAvatar');
            const profileName = document.getElementById('profileName');
            const profileType = document.getElementById('profileType');
            const profileEmail = document.getElementById('profileEmail');
            const profilePhone = document.getElementById('profilePhone');
            const profileCPF = document.getElementById('profileCPF');
            const profileAvatar = document.getElementById('profileAvatar');
            
            const displayName = currentUser.nickname || currentUser.name.split(' ')[0];
            const initials = currentUser.name.split(' ').map(n => n[0]).join('').toUpperCase();
            
            userName.textContent = displayName;
            profileName.textContent = currentUser.name;
            profileType.textContent = getUserTypeLabel(currentUser.userType);
            profileEmail.textContent = currentUser.email;
            profilePhone.textContent = currentUser.phone;
            profileCPF.textContent = maskCPF(currentUser.cpf);
            
            // Update avatars
            if (currentUser.profilePicture) {
                userAvatar.innerHTML = `<img src="${currentUser.profilePicture}" alt="Avatar">`;
                profileAvatar.innerHTML = `<img src="${currentUser.profilePicture}" alt="Avatar">`;
            } else {
                userAvatar.textContent = initials;
                profileAvatar.textContent = initials;
            }

            // Update settings form
            updateSettingsForm();
        }

        function updateSettingsForm() {
            if (!currentUser) return;

            document.getElementById('settingsName').value = currentUser.name || '';
            document.getElementById('settingsNickname').value = currentUser.nickname || '';
            document.getElementById('settingsEmail').value = currentUser.email || '';
            document.getElementById('settingsPhone').value = currentUser.phone || '';
        }

        function getUserTypeLabel(type) {
            const labels = {
                'interessado': 'Interessado(a)',
                'proprietario': 'Proprietário(a)',
                'corretor': 'Corretor(a)',
                'captador': 'Captador(a)',
                'outros': 'Outros'
            };
            return labels[type] || type;
        }

        // Navigation Functions
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remove active class from nav items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(sectionId).classList.add('active');
            
            // Add active class to clicked nav item
            if (event && event.target) {
                event.target.closest('.nav-item').classList.add('active');
            }
            
            // Load section-specific content
            if (sectionId === 'search') {
                loadCurrentProperty();
            } else if (sectionId === 'matches') {
                loadMatches();
            } else if (sectionId === 'account') {
                loadUserProperties();
            }
        }

        function showAccountTab(tabId) {
            // Remove active class from all tabs
            document.querySelectorAll('.account-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Hide all tab contents
            document.querySelectorAll('.account-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Show selected tab
            document.querySelector(`[onclick="showAccountTab('${tabId}')"]`).classList.add('active');
            document.getElementById(tabId + 'Tab').classList.add('active');

            // Load tab-specific content
            if (tabId === 'properties') {
                loadUserProperties();
            }
        }

        // Property Functions
        function setupSwipeContainer() {
            const container = document.getElementById('swipeContainer');
            
            container.addEventListener('mousedown', handleStart);
            container.addEventListener('mousemove', handleMove);
            container.addEventListener('mouseup', handleEnd);
            container.addEventListener('mouseleave', handleEnd);
            
            // Touch events for mobile
            container.addEventListener('touchstart', handleStart);
            container.addEventListener('touchmove', handleMove);
            container.addEventListener('touchend', handleEnd);
        }

        function handleStart(e) {
            const card = document.querySelector('.property-card:last-child');
            if (!card) return;
            
            isDragging = true;
            card.classList.add('dragging');
            
            const clientX = e.clientX || e.touches[0].clientX;
            const clientY = e.clientY || e.touches[0].clientY;
            
            startX = clientX;
            startY = clientY;
            currentX = clientX;
            currentY = clientY;
        }

        function handleMove(e) {
            if (!isDragging) return;
            
            e.preventDefault();
            
            const card = document.querySelector('.property-card:last-child');
            if (!card) return;
            
            const clientX = e.clientX || e.touches[0].clientX;
            const clientY = e.clientY || e.touches[0].clientY;
            
            currentX = clientX;
            currentY = clientY;
            
            const deltaX = currentX - startX;
            const deltaY = currentY - startY;
            const rotation = deltaX * 0.1;
            
            card.style.transform = `translate(${deltaX}px, ${deltaY}px) rotate(${rotation}deg)`;
            card.style.opacity = 1 - Math.abs(deltaX) / 300;
        }

        function handleEnd(e) {
            if (!isDragging) return;
            
            isDragging = false;
            
            const card = document.querySelector('.property-card:last-child');
            if (!card) return;
            
            card.classList.remove('dragging');
            
            const deltaX = currentX - startX;
            const threshold = 100;
            
            if (Math.abs(deltaX) > threshold) {
                if (deltaX > 0) {
                    // Swiped right - like
                    likeProperty();
                } else {
                    // Swiped left - reject
                    rejectProperty();
                }
            } else {
                // Snap back
                card.style.transform = '';
                card.style.opacity = '';
            }
        }

        function loadCurrentProperty() {
            const container = document.getElementById('swipeContainer');
            
            // Clear container
            container.innerHTML = '';
            
            // Get available properties (not viewed yet and not owned by current user)
            const availableProperties = properties.filter(p => 
                !viewedProperties.includes(p.id) && 
                (!p.ownerId || p.ownerId !== currentUser.id)
            );
            
            if (availableProperties.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-heart"></i>
                        <h3>Você viu todos os imóveis!</h3>
                        <p>Novos imóveis serão adicionados em breve. Que tal revisar seus matches?</p>
                    </div>
                `;
                return;
            }
            
            // Show next 3 properties (for stacking effect)
            const propertiesToShow = availableProperties.slice(0, 3);
            
            propertiesToShow.reverse().forEach((property, index) => {
                const card = createPropertyCard(property);
                card.style.zIndex = index;
                card.style.transform = `scale(${1 - index * 0.02}) translateY(${index * 4}px)`;
                container.appendChild(card);
            });
        }

        function createPropertyCard(property) {
            const card = document.createElement('div');
            card.className = 'property-card';
            card.dataset.propertyId = property.id;
            
            // Track property view when card is created
            propertyViews[property.id] = (propertyViews[property.id] || 0) + 1;
            updatePropertyStats(property.id);
            saveIntegrationData();
            
            // Add view activity
            addUserActivity('property_viewed', {
                propertyId: property.id,
                propertyTitle: property.title,
                propertyOwner: property.ownerName || 'Sistema',
                action: 'viewed'
            });
            
            card.innerHTML = `
                <img src="${property.image}" alt="${property.title}" class="property-image" 
                     onerror="this.src='https://via.placeholder.com/400x300/00214D/DAA520?text=Imóvel'">
                <div class="property-content">
                    <div class="property-price">${property.price}</div>
                    <h3 class="property-title">${property.title}</h3>
                    <div class="property-location">
                        <i class="fas fa-map-marker-alt"></i>
                        ${property.location}
                    </div>
                    <div class="property-features">
                        ${property.bedrooms > 0 ? `
                            <div class="feature">
                                <i class="fas fa-bed"></i>
                                ${property.bedrooms}
                            </div>
                        ` : ''}
                        ${property.bathrooms > 0 ? `
                            <div class="feature">
                                <i class="fas fa-bath"></i>
                                ${property.bathrooms}
                            </div>
                        ` : ''}
                        <div class="feature">
                            <i class="fas fa-ruler-combined"></i>
                            ${property.area}m²
                        </div>
                    </div>
                    <p class="property-description">${property.description}</p>
                    ${property.ownerName ? `
                        <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--border-color); font-size: 0.9rem; color: var(--text-secondary);">
                            <i class="fas fa-user"></i> Anunciado por: <strong>${property.ownerName}</strong>
                            ${property.ownerType ? `<span style="margin-left: 0.5rem; padding: 0.2rem 0.5rem; background: var(--wb-light-blue); color: var(--wb-blue); border-radius: 12px; font-size: 0.8rem;">${getUserTypeLabel(property.ownerType)}</span>` : ''}
                        </div>
                    ` : ''}
                    <div style="margin-top: 1rem; display: flex; justify-content: space-between; font-size: 0.85rem; color: var(--text-secondary);">
                        <span><i class="fas fa-eye"></i> ${property.viewCount || 0} visualizações</span>
                        <span><i class="fas fa-heart"></i> ${property.likeCount || 0} curtidas</span>
                    </div>
                </div>
            `;
            
            return card;
        }

        function likeProperty() {
            const card = document.querySelector('.property-card:last-child');
            if (!card) return;
            
            const propertyId = parseInt(card.dataset.propertyId);
            const property = properties.find(p => p.id === propertyId);
            
            if (property) {
                // Add to matches
                if (!matches.find(m => m.id === propertyId)) {
                    matches.push(property);
                }
                
                // Add to viewed
                if (!viewedProperties.includes(propertyId)) {
                    viewedProperties.push(propertyId);
                }
                
                // Track property like in integration system
                propertyLikes[propertyId] = (propertyLikes[propertyId] || 0) + 1;
                
                // Add activity
                addUserActivity('property_liked', {
                    propertyId: propertyId,
                    propertyTitle: property.title,
                    propertyOwner: property.ownerName || 'Sistema'
                });
                
                // Update property stats
                updatePropertyStats(propertyId);
                
                // Save data
                saveData();
                saveIntegrationData();
                
                // Show match modal
                showMatchModal();
                
                // Update stats
                updateDashboardStats();
            }
            
            // Animate card out
            card.classList.add('swiped-right');
            
            // Load next property after animation
            setTimeout(() => {
                loadCurrentProperty();
            }, 300);
        }

        function rejectProperty() {
            const card = document.querySelector('.property-card:last-child');
            if (!card) return;
            
            const propertyId = parseInt(card.dataset.propertyId);
            const property = properties.find(p => p.id === propertyId);
            
            // Add to viewed
            if (!viewedProperties.includes(propertyId)) {
                viewedProperties.push(propertyId);
            }
            
            // Track property view in integration system
            propertyViews[propertyId] = (propertyViews[propertyId] || 0) + 1;
            
            // Add activity
            if (property) {
                addUserActivity('property_viewed', {
                    propertyId: propertyId,
                    propertyTitle: property.title,
                    propertyOwner: property.ownerName || 'Sistema',
                    action: 'rejected'
                });
            }
            
            // Update property stats
            updatePropertyStats(propertyId);
            
            // Save data
            saveData();
            saveIntegrationData();
            
            // Update stats
            updateDashboardStats();
            
            // Animate card out
            card.classList.add('swiped-left');
            
            // Load next property after animation
            setTimeout(() => {
                loadCurrentProperty();
            }, 300);
        }

        function superLikeProperty() {
            // For now, same as like but could have special behavior
            likeProperty();
        }

        function filterProperties(type) {
            // Update filter buttons
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Filter properties (for now, just reload - could implement actual filtering)
            loadCurrentProperty();
        }

        // Property Modal Functions
        function showPropertyModal(property = null) {
            currentEditingProperty = property;
            uploadedImages = [];
            
            const modal = document.getElementById('propertyModal');
            const title = document.getElementById('propertyModalTitle');
            const submitText = document.getElementById('propertySubmitText');
            const form = document.getElementById('propertyForm');
            
            if (property) {
                title.textContent = 'Editar Imóvel';
                submitText.textContent = 'Salvar Alterações';
                fillPropertyForm(property);
            } else {
                title.textContent = 'Cadastrar Imóvel';
                submitText.textContent = 'Cadastrar Imóvel';
                form.reset();
                document.getElementById('imageGallery').innerHTML = '';
            }
            
            modal.classList.add('active');
        }

        function closePropertyModal() {
            document.getElementById('propertyModal').classList.remove('active');
            currentEditingProperty = null;
            uploadedImages = [];
        }

        function fillPropertyForm(property) {
            document.getElementById('propertyId').value = property.id;
            document.getElementById('propertyTitle').value = property.title;
            document.getElementById('propertyType').value = property.type;
            document.getElementById('propertyPurpose').value = property.purpose || 'venda';
            document.getElementById('propertyCEP').value = property.cep || '';
            document.getElementById('propertyState').value = property.state || '';
            document.getElementById('propertyCity').value = property.city || '';
            document.getElementById('propertyNeighborhood').value = property.neighborhood || '';
            document.getElementById('propertyAddress').value = property.address || '';
            document.getElementById('propertyBedrooms').value = property.bedrooms;
            document.getElementById('propertyBathrooms').value = property.bathrooms;
            document.getElementById('propertyArea').value = property.area;
            document.getElementById('propertyGarage').value = property.garage || '';
            document.getElementById('propertyPrice').value = property.price;
            document.getElementById('propertyCondo').value = property.condo || '';
            document.getElementById('propertyIPTU').value = property.iptu || '';
            document.getElementById('propertyDescription').value = property.description;
            
            // Load existing images
            if (property.images && property.images.length > 0) {
                uploadedImages = [...property.images];
                updateImageGallery();
            }
        }

        function handlePropertySubmit(event) {
            event.preventDefault();
            
            const formData = {
                id: currentEditingProperty ? currentEditingProperty.id : Date.now(),
                title: document.getElementById('propertyTitle').value,
                type: document.getElementById('propertyType').value,
                purpose: document.getElementById('propertyPurpose').value,
                cep: document.getElementById('propertyCEP').value,
                state: document.getElementById('propertyState').value,
                city: document.getElementById('propertyCity').value,
                neighborhood: document.getElementById('propertyNeighborhood').value,
                address: document.getElementById('propertyAddress').value,
                bedrooms: parseInt(document.getElementById('propertyBedrooms').value) || 0,
                bathrooms: parseInt(document.getElementById('propertyBathrooms').value) || 0,
                area: parseInt(document.getElementById('propertyArea').value) || 0,
                garage: parseInt(document.getElementById('propertyGarage').value) || 0,
                price: document.getElementById('propertyPrice').value,
                condo: document.getElementById('propertyCondo').value,
                iptu: document.getElementById('propertyIPTU').value,
                description: document.getElementById('propertyDescription').value,
                images: uploadedImages,
                image: uploadedImages[0] || 'https://via.placeholder.com/400x300/00214D/DAA520?text=Imóvel',
                location: `${document.getElementById('propertyNeighborhood').value}, ${document.getElementById('propertyCity').value} - ${document.getElementById('propertyState').value}`,
                ownerId: currentUser.id,
                ownerName: currentUser.name,
                ownerType: currentUser.userType,
                status: 'active',
                viewCount: 0,
                likeCount: 0,
                createdAt: currentEditingProperty ? currentEditingProperty.createdAt : new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };
            
            if (currentEditingProperty) {
                // Update existing property
                const index = userProperties.findIndex(p => p.id === currentEditingProperty.id);
                if (index !== -1) {
                    userProperties[index] = formData;
                }
                
                // Update in main properties array
                const mainIndex = properties.findIndex(p => p.id === currentEditingProperty.id);
                if (mainIndex !== -1) {
                    properties[mainIndex] = formData;
                }
                
                // Update in global properties
                const globalIndex = globalProperties.findIndex(p => p.id === currentEditingProperty.id);
                if (globalIndex !== -1) {
                    globalProperties[globalIndex] = formData;
                    saveGlobalProperties();
                }
                
                showToast('Imóvel atualizado com sucesso!', 'success');
            } else {
                // Add new property
                userProperties.push(formData);
                properties.push(formData);
                globalProperties.push(formData);
                
                // Add property creation activity
                addUserActivity('property_added', formData);
                
                // Save global properties
                saveGlobalProperties();
                
                showToast('Imóvel cadastrado com sucesso!', 'success');
            }
            
            // Save data
            saveData();
            saveIntegrationData();
            
            // Update dashboard stats
            updateDashboardStats();
            
            // Reload user properties
            loadUserProperties();
            
            // Close modal
            closePropertyModal();
        }

        function handleImageUpload(event) {
            const files = event.target.files;
            
            if (uploadedImages.length + files.length > 10) {
                showToast('Máximo de 10 imagens permitidas!', 'warning');
                return;
            }
            
            Array.from(files).forEach(file => {
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        uploadedImages.push(e.target.result);
                        updateImageGallery();
                    };
                    reader.readAsDataURL(file);
                }
            });
        }

        function updateImageGallery() {
            const gallery = document.getElementById('imageGallery');
            gallery.innerHTML = uploadedImages.map((image, index) => `
                <div class="image-item">
                    <img src="${image}" alt="Imagem ${index + 1}">
                    <button type="button" class="image-remove" onclick="removeImage(${index})">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `).join('');
        }

        function removeImage(index) {
            uploadedImages.splice(index, 1);
            updateImageGallery();
        }

        // User Properties Functions
        function loadUserProperties() {
            const grid = document.getElementById('myPropertiesGrid');
            const myProperties = userProperties.filter(p => p.ownerId === currentUser.id);
            
            if (myProperties.length === 0) {
                grid.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <i class="fas fa-home"></i>
                        <h3>Nenhum imóvel cadastrado</h3>
                        <p>Cadastre seu primeiro imóvel para começar a receber interessados!</p>
                    </div>
                `;
                return;
            }
            
            grid.innerHTML = myProperties.map(property => `
                <div class="my-property-card">
                    <div class="property-status status-${property.status}">
                        ${property.status === 'active' ? 'Ativo' : property.status === 'pending' ? 'Pendente' : 'Inativo'}
                    </div>
                    <img src="${property.image}" alt="${property.title}" class="my-property-image"
                         onerror="this.src='https://via.placeholder.com/350x200/00214D/DAA520?text=Imóvel'">
                    <div class="my-property-content">
                        <div class="my-property-price">${property.price}</div>
                        <h3 class="my-property-title">${property.title}</h3>
                        <div class="my-property-location">
                            <i class="fas fa-map-marker-alt"></i>
                            ${property.location}
                        </div>
                        <div class="property-features">
                            ${property.bedrooms > 0 ? `
                                <div class="feature">
                                    <i class="fas fa-bed"></i>
                                    ${property.bedrooms}
                                </div>
                            ` : ''}
                            ${property.bathrooms > 0 ? `
                                <div class="feature">
                                    <i class="fas fa-bath"></i>
                                    ${property.bathrooms}
                                </div>
                            ` : ''}
                            <div class="feature">
                                <i class="fas fa-ruler-combined"></i>
                                ${property.area}m²
                            </div>
                        </div>
                        <div class="property-actions">
                            <button class="btn-edit" onclick="showPropertyModal(${JSON.stringify(property).replace(/"/g, '&quot;')})">
                                <i class="fas fa-edit"></i> Editar
                            </button>
                            <button class="btn-danger" onclick="deleteProperty(${property.id})">
                                <i class="fas fa-trash"></i> Excluir
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function deleteProperty(propertyId) {
            if (confirm('Tem certeza que deseja excluir este imóvel?')) {
                // Remove from user properties
                userProperties = userProperties.filter(p => p.id !== propertyId);
                
                // Remove from main properties
                properties = properties.filter(p => p.id !== propertyId);
                
                // Remove from matches if exists
                matches = matches.filter(m => m.id !== propertyId);
                
                // Save data
                saveData();
                
                // Update dashboard stats
                updateDashboardStats();
                
                // Reload user properties
                loadUserProperties();
                
                showToast('Imóvel excluído com sucesso!', 'success');
            }
        }

        // Profile Functions
        function changeProfilePicture() {
            document.getElementById('profilePictureInput').click();
        }

        function handleProfilePictureUpload(event) {
            const file = event.target.files[0];
            if (file && file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    currentUser.profilePicture = e.target.result;
                    
                    // Update user in localStorage
                    const users = JSON.parse(localStorage.getItem('users') || '[]');
                    const userIndex = users.findIndex(u => u.id === currentUser.id);
                    if (userIndex !== -1) {
                        users[userIndex] = currentUser;
                        localStorage.setItem('users', JSON.stringify(users));
                    }
                    
                    localStorage.setItem('currentUser', JSON.stringify(currentUser));
                    
                    // Update UI
                    updateUserInfo();
                    
                    showToast('Foto de perfil atualizada!', 'success');
                };
                reader.readAsDataURL(file);
            }
        }

        function editProfile() {
            showAccountTab('settings');
        }

        function handleSettingsUpdate(event) {
            event.preventDefault();
            
            const name = document.getElementById('settingsName').value;
            const nickname = document.getElementById('settingsNickname').value;
            const email = document.getElementById('settingsEmail').value;
            const phone = document.getElementById('settingsPhone').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            // Validate passwords if provided
            if (newPassword && newPassword !== confirmPassword) {
                showToast('As senhas não coincidem!', 'error');
                return;
            }
            
            // Update user data
            currentUser.name = name;
            currentUser.nickname = nickname;
            currentUser.email = email;
            currentUser.phone = formatPhone(phone);
            
            if (newPassword) {
                currentUser.password = newPassword;
            }
            
            // Update user in localStorage
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            const userIndex = users.findIndex(u => u.id === currentUser.id);
            if (userIndex !== -1) {
                users[userIndex] = currentUser;
                localStorage.setItem('users', JSON.stringify(users));
            }
            
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            
            // Update UI
            updateUserInfo();
            
            showToast('Configurações salvas com sucesso!', 'success');
        }

        // Match Functions
        function showMatchModal() {
            document.getElementById('matchModal').classList.add('active');
        }

        function closeMatchModal() {
            document.getElementById('matchModal').classList.remove('active');
        }

        function loadMatches() {
            const grid = document.getElementById('matchesGrid');
            
            if (matches.length === 0) {
                grid.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <i class="fas fa-heart"></i>
                        <h3>Nenhum match ainda</h3>
                        <p>Comece a curtir imóveis na seção "Buscar" para ver seus matches aqui!</p>
                    </div>
                `;
                return;
            }
            
            grid.innerHTML = matches.map(property => `
                <div class="match-card">
                    <img src="${property.image}" alt="${property.title}" class="match-image"
                         onerror="this.src='https://via.placeholder.com/300x200/00214D/DAA520?text=Imóvel'">
                    <div class="match-content">
                        <div class="match-price">${property.price}</div>
                        <h3 class="match-title">${property.title}</h3>
                        <div class="match-location">
                            <i class="fas fa-map-marker-alt"></i>
                            ${property.location}
                        </div>
                        <div class="match-features">
                            ${property.bedrooms > 0 ? `
                                <div class="feature">
                                    <i class="fas fa-bed"></i>
                                    ${property.bedrooms}
                                </div>
                            ` : ''}
                            ${property.bathrooms > 0 ? `
                                <div class="feature">
                                    <i class="fas fa-bath"></i>
                                    ${property.bathrooms}
                                </div>
                            ` : ''}
                            <div class="feature">
                                <i class="fas fa-ruler-combined"></i>
                                ${property.area}m²
                            </div>
                        </div>
                        <button class="contact-btn" onclick="contactProperty(${property.id})">
                            <i class="fas fa-phone"></i> Entrar em Contato
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function contactProperty(propertyId) {
            showToast('Funcionalidade de contato será implementada em breve!', 'warning');
        }

        // Navigation Functions
        function navigateToSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Show target section
            document.getElementById(sectionId).classList.add('active');
            
            // Update navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Find and activate corresponding nav item
            const navItem = document.querySelector(`[onclick="showSection('${sectionId}')"]`);
            if (navItem) {
                navItem.classList.add('active');
            }
            
            // Special handling for specific sections
            if (sectionId === 'search') {
                // Reset to swipe mode when navigating to search
                document.getElementById('swipeContainer').style.display = 'block';
                document.getElementById('searchResultsContainer').innerHTML = '';
                document.getElementById('resultsHeader').style.display = 'none';
                loadCurrentProperty();
            } else if (sectionId === 'matches') {
                loadMatches();
            }
            
            showToast(`Navegando para ${getSectionName(sectionId)}`, 'success');
        }

        function navigateToAccountTab(tabId) {
            // First navigate to account section
            navigateToSection('conta');
            
            // Then switch to specific tab
            setTimeout(() => {
                switchAccountTab(tabId);
            }, 100);
        }

        function showPropertyViewsDetails() {
            // Navigate to account section and show properties tab
            navigateToAccountTab('properties');
            
            // Show detailed view of property statistics
            setTimeout(() => {
                showToast('Visualizando estatísticas detalhadas dos seus imóveis', 'info');
            }, 200);
        }

        function getSectionName(sectionId) {
            const sectionNames = {
                'dashboard': 'Dashboard',
                'search': 'Buscar Imóveis',
                'matches': 'Seus Matches',
                'cadastrar': 'Cadastrar Imóvel',
                'conta': 'Sua Conta'
            };
            return sectionNames[sectionId] || sectionId;
        }
        function updateDashboardStats() {
            document.getElementById('viewedCount').textContent = viewedProperties.length;
            document.getElementById('matchCount').textContent = matches.length;
            document.getElementById('myPropertiesCount').textContent = userProperties.filter(p => p.ownerId === currentUser.id).length;
            
            // Calculate total views for user's properties
            const userPropertyViews = userProperties
                .filter(p => p.ownerId === currentUser.id)
                .reduce((total, prop) => total + (propertyViews[prop.id] || 0), 0);
            document.getElementById('propertyViewsCount').textContent = userPropertyViews;
            
            // Load recent activities
            loadRecentActivities();
        }

        function loadRecentActivities() {
            const activityContainer = document.getElementById('recentActivity');
            
            if (userActivity.length === 0) {
                activityContainer.innerHTML = `
                    <p style="color: var(--text-secondary); text-align: center; padding: 2rem;">
                        Nenhuma atividade recente. Comece explorando imóveis na seção "Buscar"!
                    </p>
                `;
                return;
            }

            // Show last 5 activities
            const recentActivities = userActivity.slice(0, 5);
            
            activityContainer.innerHTML = recentActivities.map(activity => {
                const timeAgo = getTimeAgo(new Date(activity.timestamp));
                let activityText = '';
                let activityIcon = '';
                let activityColor = '';

                switch (activity.type) {
                    case 'property_added':
                        activityText = `${activity.userName} cadastrou "${activity.data.title}"`;
                        activityIcon = 'fas fa-plus-circle';
                        activityColor = 'var(--success)';
                        break;
                    case 'property_liked':
                        activityText = `${activity.userName} curtiu "${activity.data.propertyTitle}"`;
                        activityIcon = 'fas fa-heart';
                        activityColor = 'var(--error)';
                        break;
                    case 'property_viewed':
                        if (activity.data.action === 'rejected') {
                            activityText = `${activity.userName} rejeitou "${activity.data.propertyTitle}"`;
                            activityIcon = 'fas fa-times-circle';
                            activityColor = 'var(--text-secondary)';
                        } else {
                            activityText = `${activity.userName} visualizou "${activity.data.propertyTitle}"`;
                            activityIcon = 'fas fa-eye';
                            activityColor = 'var(--wb-blue)';
                        }
                        break;
                    case 'user_registered':
                        activityText = `${activity.userName} se juntou ao iFinder`;
                        activityIcon = 'fas fa-user-plus';
                        activityColor = 'var(--wb-gold)';
                        break;
                    default:
                        activityText = `${activity.userName} realizou uma ação`;
                        activityIcon = 'fas fa-info-circle';
                        activityColor = 'var(--text-secondary)';
                }

                return `
                    <div style="display: flex; align-items: center; gap: 1rem; padding: 0.75rem 0; border-bottom: 1px solid var(--border-color);">
                        <div style="width: 40px; height: 40px; background: ${activityColor}20; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: ${activityColor};">
                            <i class="${activityIcon}"></i>
                        </div>
                        <div style="flex: 1;">
                            <p style="margin: 0; font-size: 0.9rem; color: var(--text-primary);">${activityText}</p>
                            <p style="margin: 0; font-size: 0.8rem; color: var(--text-secondary);">${timeAgo}</p>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function getTimeAgo(date) {
            const now = new Date();
            const diffInSeconds = Math.floor((now - date) / 1000);
            
            if (diffInSeconds < 60) return 'Agora mesmo';
            if (diffInSeconds < 3600) return `${Math.floor(diffInSeconds / 60)} min atrás`;
            if (diffInSeconds < 86400) return `${Math.floor(diffInSeconds / 3600)}h atrás`;
            if (diffInSeconds < 604800) return `${Math.floor(diffInSeconds / 86400)} dias atrás`;
            
            return date.toLocaleDateString('pt-BR');
        }

        // Utility Functions
        function validateCPF(cpf) {
            cpf = cpf.replace(/[^\d]/g, '');
            
            if (cpf.length !== 11 || /^(\d)\1{10}$/.test(cpf)) {
                return false;
            }
            
            let sum = 0;
            for (let i = 0; i < 9; i++) {
                sum += parseInt(cpf.charAt(i)) * (10 - i);
            }
            let remainder = 11 - (sum % 11);
            if (remainder === 10 || remainder === 11) remainder = 0;
            if (remainder !== parseInt(cpf.charAt(9))) return false;
            
            sum = 0;
            for (let i = 0; i < 10; i++) {
                sum += parseInt(cpf.charAt(i)) * (11 - i);
            }
            remainder = 11 - (sum % 11);
            if (remainder === 10 || remainder === 11) remainder = 0;
            if (remainder !== parseInt(cpf.charAt(10))) return false;
            
            return true;
        }

        function formatCPF(cpf) {
            cpf = cpf.replace(/[^\d]/g, '');
            return cpf.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4');
        }

        function maskCPF(cpf) {
            return cpf.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '***.$2.***-**');
        }

        function formatPhone(phone) {
            phone = phone.replace(/[^\d]/g, '');
            if (phone.length === 11) {
                return phone.replace(/(\d{2})(\d{5})(\d{4})/, '($1) $2-$3');
            } else if (phone.length === 10) {
                return phone.replace(/(\d{2})(\d{4})(\d{4})/, '($1) $2-$3');
            }
            return phone;
        }

        function showToast(message, type = 'success') {
            // Remove existing toast
            const existingToast = document.querySelector('.toast');
            if (existingToast) {
                existingToast.remove();
            }
            
            // Create new toast
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            
            const icon = type === 'success' ? 'check-circle' : 
                        type === 'error' ? 'exclamation-circle' : 
                        'exclamation-triangle';
            
            toast.innerHTML = `
                <i class="fas fa-${icon}"></i>
                <span>${message}</span>
            `;
            
            document.body.appendChild(toast);
            
            // Show toast
            setTimeout(() => toast.classList.add('show'), 100);
            
            // Hide toast
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // Auto-format inputs
        document.addEventListener('input', function(e) {
            if (e.target.id === 'registerPhone' || e.target.id === 'settingsPhone') {
                e.target.value = formatPhone(e.target.value);
            } else if (e.target.id === 'registerCPF') {
                e.target.value = formatCPF(e.target.value);
            } else if (e.target.id === 'propertyPrice' || e.target.id === 'propertyCondo' || e.target.id === 'propertyIPTU') {
                // Format currency inputs
                let value = e.target.value.replace(/[^\d]/g, '');
                if (value) {
                    value = (parseInt(value) / 100).toLocaleString('pt-BR', {
                        style: 'currency',
                        currency: 'BRL'
                    });
                    e.target.value = value;
                }
            }
        });

        // Close modals when clicking outside
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('modal')) {
                e.target.classList.remove('active');
            }
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('appContainer').classList.contains('active')) {
                if (e.key === 'ArrowLeft') {
                    rejectProperty();
                } else if (e.key === 'ArrowRight') {
                    likeProperty();
                } else if (e.key === 'ArrowUp') {
                    superLikeProperty();
                }
            }
        });
    </script>
</body>
</html>

